<!DOCTYPE html>
<html lang="en">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>Heap basics</title>
  
  <link rel="canonical" href="http://mykonos-x.github.io/2023/10/02/Heap-basics/">
  
  <meta name="description" content="ç¿»åˆ°ä»¥å‰çš„ç¬”è®°ï¼Œæ•´ç†ä¸€ä¸‹    å †  ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜ å¤šçº¿ç¨‹ä¸Arena ç»´æŠ¤å¤šä¸ªå † chunkçš„ç»“æ„ Binçš„ç»“æ„ å†…å­˜åˆ†é…æµç¨‹ å†…å­˜é‡Šæ”¾æµç¨‹     å † elfä¸­çš„å †å’Œç®—æ³•æåˆ°çš„å †ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œelfä¸­æåˆ°çš„å †æ˜¯è¢«åˆ†é…åˆ°çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå’Œæ ˆçš„åŒºåˆ«ä¸»è¦æ˜¯åœ¨äºå †å†…å­˜æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå¯">
  
  
  <meta name="author" content="ymepetb">
  
  
  
  <meta property="og:site_name" content="Silence to hear." />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Heap basics" />
  
  <meta property="og:description" content="ç¿»åˆ°ä»¥å‰çš„ç¬”è®°ï¼Œæ•´ç†ä¸€ä¸‹    å †  ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜ å¤šçº¿ç¨‹ä¸Arena ç»´æŠ¤å¤šä¸ªå † chunkçš„ç»“æ„ Binçš„ç»“æ„ å†…å­˜åˆ†é…æµç¨‹ å†…å­˜é‡Šæ”¾æµç¨‹     å † elfä¸­çš„å †å’Œç®—æ³•æåˆ°çš„å †ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œelfä¸­æåˆ°çš„å †æ˜¯è¢«åˆ†é…åˆ°çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå’Œæ ˆçš„åŒºåˆ«ä¸»è¦æ˜¯åœ¨äºå †å†…å­˜æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå¯">
  
  <meta property="og:url" content="http://mykonos-x.github.io/2023/10/02/Heap-basics/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Heap basics">
  
  <meta name="twitter:description" content="ç¿»åˆ°ä»¥å‰çš„ç¬”è®°ï¼Œæ•´ç†ä¸€ä¸‹    å †  ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜ å¤šçº¿ç¨‹ä¸Arena ç»´æŠ¤å¤šä¸ªå † chunkçš„ç»“æ„ Binçš„ç»“æ„ å†…å­˜åˆ†é…æµç¨‹ å†…å­˜é‡Šæ”¾æµç¨‹     å † elfä¸­çš„å †å’Œç®—æ³•æåˆ°çš„å †ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œelfä¸­æåˆ°çš„å †æ˜¯è¢«åˆ†é…åˆ°çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå’Œæ ˆçš„åŒºåˆ«ä¸»è¦æ˜¯åœ¨äºå †å†…å­˜æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå¯">
  
  
  
  
  <meta name="twitter:url" content="http://mykonos-x.github.io/2023/10/02/Heap-basics/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #7cc1df;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #7cc1df 50%
    );
  }
  blockquote {
    border-left: 8px solid #7cc1df;
  }
  .nanobar .bar {
    background: #7cc1df;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #7cc1df;
    border-color: #7cc1df;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #7cc1df;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒ‘</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>â˜€ï¸</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi there.
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
          
          <a href="/about" class="ml">About</a>
          
        
        
          
            <a href="mailto:g0dzirrazhou@gmail.com" target="_blank" class="ml">Email</a>
          
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h2>Heap basics</h2>

  <p>ç¿»åˆ°ä»¥å‰çš„ç¬”è®°ï¼Œæ•´ç†ä¸€ä¸‹</p>
<!-- toc -->
<ul class="lvl-0">
<li class="lvl-2">
<p><a href="#%E5%A0%86">å †</a></p>
<ul class="lvl-2">
<li class="lvl-4"><a href="#%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E7%9A%84%E5%86%85%E5%AD%98">ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜</a></li>
<li class="lvl-4"><a href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8Earena">å¤šçº¿ç¨‹ä¸Arena</a></li>
<li class="lvl-4"><a href="#%E7%BB%B4%E6%8A%A4%E5%A4%9A%E4%B8%AA%E5%A0%86">ç»´æŠ¤å¤šä¸ªå †</a></li>
<li class="lvl-4"><a href="#chunk%E7%9A%84%E7%BB%93%E6%9E%84">chunkçš„ç»“æ„</a></li>
<li class="lvl-4"><a href="#bin%E7%9A%84%E7%BB%93%E6%9E%84">Binçš„ç»“æ„</a></li>
<li class="lvl-4"><a href="#%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E6%B5%81%E7%A8%8B">å†…å­˜åˆ†é…æµç¨‹</a></li>
<li class="lvl-4"><a href="#%E5%86%85%E5%AD%98%E9%87%8A%E6%94%BE%E6%B5%81%E7%A8%8B">å†…å­˜é‡Šæ”¾æµç¨‹</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h2><span id="å †">å †</span></h2>
<p>elfä¸­çš„å †å’Œç®—æ³•æåˆ°çš„å †ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œelfä¸­æåˆ°çš„å †æ˜¯è¢«åˆ†é…åˆ°çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå’Œæ ˆçš„åŒºåˆ«ä¸»è¦æ˜¯åœ¨äºå †å†…å­˜æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå¯ä»¥ä»<code>heap</code>æ®µè¯·æ±‚ä¸€å—å†…å­˜ï¼Œæˆ–è€…é‡Šæ”¾ä¸€å—å†…å­˜</p>
<p>å †å†…å­˜æ˜¯å…¨å±€çš„ï¼Œå³åœ¨ç¨‹åºçš„ä»»æ„ä½ç½®éƒ½å¯ä»¥è®¿é—®å †ï¼Œå¹¶ä¸ä¸€å®šæ˜¯è¦åœ¨<code>malloc</code>é‚£ä¸ªå‡½æ•°é‡Œè®¿é—®ï¼Œå› ä¸ºCè¯­è¨€ä½¿ç”¨æŒ‡é’ˆæŒ‡å‘åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚ä½†ç›¸æ¯”è®¿é—®æ ˆä¸Šçš„é™æ€å±€éƒ¨å˜é‡ï¼Œä½¿ç”¨æŒ‡é’ˆä¹Ÿä¼šå¸¦æ¥ä¸€å®šçš„å¼€é”€</p>
<p>ï¼ˆä»ä½åœ°å€ $$\rightarrow$$ é«˜åœ°å€ï¼‰</p>
<h3><span id="ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜">ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜</span></h3>
<p>GLibcé‡‡ç”¨ptmalloc2å†…å­˜åˆ†é…å™¨ç®¡ç†å †å†…å­˜ï¼Œå¢åŠ äº†å¯¹<code>å¤šçº¿ç¨‹</code>çš„æ”¯æŒ</p>
<h4><span id="mmap">mmap</span></h4>
<p>ç”¨äºåˆ›å»ºç§æœ‰çš„åŒ¿åæ˜ å°„æ®µï¼Œä¸»è¦æ˜¯ä¸ºäº†åˆ†é…ä¸€å—æ–°çš„å†…å­˜ï¼Œä¸”è¿™å—å†…å­˜åªæœ‰è°ƒç”¨mmapçš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸ºç§æœ‰çš„ï¼Œä¸ä¹‹ç›¸åçš„æ“ä½œæ˜¯<code>munmap()</code>ï¼Œåˆ é™¤ä¸€å—å†…å­˜åŒºåŸŸä¸Šçš„æ˜ å°„</p>
<h3><span id="å¤šçº¿ç¨‹ä¸arena">å¤šçº¿ç¨‹ä¸Arena</span></h3>
<p>æ¯ä¸ªçº¿ç¨‹è¦ç»´æŠ¤ä¸€äº›ç‹¬ç«‹çš„æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”å¯¹è¿™äº›æ•°æ®ç»“æ„çš„è®¿é—®æ˜¯éœ€è¦åŠ é”çš„ã€‚åœ¨ptmalloc2ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„freelistï¼ˆbinsï¼‰ï¼Œä¹Ÿå°±æ˜¯ç»´æŠ¤ç©ºé—²å†…å­˜çš„ä¸€ä¸ªé“¾è¡¨ï¼›ä»¥åŠè‡ªå·±çš„arenaï¼Œä¸€æ®µè¿ç»­çš„å †å†…å­˜åŒºåŸŸã€‚ç‰¹åˆ«çš„ï¼Œä¸»çº¿ç¨‹çš„arenaå«åšmain_arenaï¼Œæ³¨æ„åªæœ‰main_arenaå¯ä»¥è®¿é—®heapæ®µå’Œmmapæ˜ å°„åŒºåŸŸï¼Œnon_main_arenaåªèƒ½è®¿é—®mmapæ˜ å°„åŒºåŸŸ</p>
<blockquote>
<p>çº¿ç¨‹è¾ƒå¤šæ—¶ï¼Œäº’æ–¥é”æœºåˆ¶å¯¼è‡´æ€§èƒ½ä¸‹é™</p>
</blockquote>
<p>ç¬¬ä¸€æ¬¡ç”³è¯·å†…å­˜æ—¶è¿˜æ²¡æœ‰heapæ®µï¼Œå› æ­¤é€šè¿‡å‘ä¸Šç§»åŠ¨brk()ï¼Œæˆ‘ä»¬çš„main_arenaï¼ˆ132KBçš„heapæ®µï¼‰ä¼šè¢«åˆ›å»ºã€‚æ— è®ºåç»­ç”³è¯·çš„å†…å­˜å¤šå¤§ï¼Œmallocéƒ½ä¼šä»main_arenaä¸­å°è¯•å–å‡ºä¸€å°å—å†…å­˜æ¥è¿›è¡Œåˆ†é…ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿï¼Œmain_arenaå¯ä»¥é€šè¿‡brk()æ‰©å¼ ï¼Œå¦‚æœç©ºé—²å¤ªå¤šï¼Œä¹Ÿå¯ä»¥ç¼©å°</p>
<p>å¯¹äºnon_main_arenaï¼Œæ˜¯ç”±mmap()åˆ›å»ºçš„1MBçš„å†…å­˜ç©ºé—´æ˜ å°„åˆ°è¿›ç¨‹åœ°å€çš„ç©ºé—´ï¼Œä¸è¿‡å®é™…ä¸Šä¹Ÿåªæœ‰132KBå¯è¯»å¯å†™ï¼Œè¿™132KBå°±æ˜¯è¯¥çº¿ç¨‹çš„heapç»“æ„ï¼Œæˆ–è€…å«non_main_arena</p>
<blockquote>
<p>å½“ç”³è¯·çš„ç©ºé—´å¤§äº128KBä¸”arenaæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ—¶ï¼Œæ— è®ºåœ¨å“ªä¸ªarenaé‡Œéƒ½åªèƒ½é€šè¿‡mmap()åˆ†é…å†…å­˜</p>
</blockquote>
<h3><span id="ç»´æŠ¤å¤šä¸ªå †">ç»´æŠ¤å¤šä¸ªå †</span></h3>
<p>main_arenaåªæœ‰ä¸€ä¸ªå †ï¼Œå¯ä»¥çµæ´»çš„ç¼©æ”¾</p>
<p>non_main_arenaå¯ä»¥åˆ›å»ºå¤šä¸ªå †</p>
<p>æ‰€ä»¥åœ¨non_main_arenaä¸­ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å¦‚ä½•ç»´æŠ¤å¤šä¸ªå †çš„é—®é¢˜ï¼Œè¿™é‡Œæ¶‰åŠåˆ°ä¸‰ä¸ªå¤´éƒ¨ï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>heap_infoï¼šæ¯ä¸ªheapçš„å¤´éƒ¨ï¼Œmain_arenaæ˜¯æ²¡æœ‰çš„</p>
</li>
<li class="lvl-2">
<p>malloc_stateï¼šarenaçš„å¤´éƒ¨ï¼Œmain_arenaçš„è¿™ä¸ªéƒ¨åˆ†æ˜¯å…¨å±€å˜é‡è€Œä¸å±äºå †æ®µ</p>
</li>
<li class="lvl-2">
<p>malloc_chunkï¼šæ¯ä¸ªchunkçš„å¤´éƒ¨</p>
</li>
</ul>
<h3><span id="chunkçš„ç»“æ„">chunkçš„ç»“æ„</span></h3>
<h4><span id="allocate-chunk">Allocate chunk</span></h4>
<p><img src="https://pic.imgdb.cn/item/651ab55ac458853aef14120d.jpg" alt></p>
<p>prev_sizeï¼šåªæœ‰åœ¨å‰ä¸€ä¸ªchunkç©ºé—²æ—¶æ‰ä¼šè¡¨ç¤ºå‰ä¸€ä¸ªå—çš„å¤§å°ï¼Œå¦åˆ™è¿™é‡Œæ˜¯æ— æ•ˆçš„ï¼Œå¯ä»¥è¢«å‰ä¸€ä¸ªchunkå¾ç”¨ï¼ˆå­˜å‚¨ç”¨æˆ·æ•°æ®ï¼‰</p>
<p>Pï¼š<code>PREV_INUSE</code> =&gt; ä¹‹å‰çš„chunkå·²ç»è¢«åˆ†é…åˆ™ä¸º1</p>
<p>Mï¼š<code>IS_MAPPED</code> =&gt; å½“å‰chunkæ˜¯mmap()å¾—åˆ°çš„åˆ™ä¸º1</p>
<p>Nï¼š<code>NON_MAIN_ARENA</code> =&gt; å½“å‰chunkåœ¨non_main_arenaé‡Œåˆ™ä¸º1</p>
<p>memæŒ‡é’ˆï¼šè°ƒç”¨mallocæ—¶è¿”å›ç»™ç”¨æˆ·çš„æŒ‡é’ˆã€‚å®é™…ä¸Šï¼ŒçœŸæ­£çš„chunkæ˜¯ä»<code>chunk</code>æŒ‡é’ˆå¼€å§‹çš„</p>
<p>ç”¨æˆ·ç”³è¯·çš„å†…å­˜å¤§å°ä¸ä¸€å®šæ˜¯ç”¨æˆ·æ•°æ®å¯ç”¨çš„å†…å­˜å¤§å°ï¼Œç”±äºå­—èŠ‚å¯¹é½é—®é¢˜ã€‚è¦è·å¾—å¯ç”¨å†…å­˜å¤§å°ï¼Œå¯ä»¥ç”¨malloc_usable__size()è·å¾—</p>
<h4><span id="free-chunk">Free chunk</span></h4>
<p>ç›¸æ¯”äºAllocate chunkï¼Œfdå’Œbkç”Ÿæ•ˆäº†ã€‚</p>
<p>ç”±äºfree chunkä¼šä¸€ç›´åˆå¹¶ï¼ŒçŸ¥é“å‰ä¸€ä¸ªchunkæ˜¯allocate chunkï¼Œæ‰€ä»¥free chunkçš„prev_sizeå¿…å®šä¼šè¢«ä¸Šä¸€ä¸ªchunkå¾ç”¨ï¼Œç”¨äºå­˜æ”¾ç”¨æˆ·æ•°æ®</p>
<p>bk =&gt; back  /  fd =&gt; forwardï¼ˆæŒ‡åœ¨binsä¸­ï¼‰</p>
<h4><span id="top-chunk">Top chunk</span></h4>
<p>ä¸å±äºbinsï¼Œå¤„äºarenaé¡¶éƒ¨ã€‚å½“æ‰€æœ‰çš„binä¸­éƒ½æ²¡æœ‰ç©ºé—²çš„å¯ç”¨chunkæ—¶ï¼Œæˆ‘ä»¬åˆ‡å‰²top chunkæ¥æ»¡è¶³ç”¨æˆ·çš„å†…å­˜ç”³è¯·ã€‚å‡è®¾top chunkå½“å‰å¤§å°ä¸ºNå­—èŠ‚ï¼Œç”¨æˆ·ç”³è¯·äº†Kå­—èŠ‚çš„å†…å­˜ï¼Œé‚£ä¹ˆtop chunkä¼šè¢«åˆ‡å‰²ä¸ºï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>ä¸€ä¸ªkå­—èŠ‚çš„chunkï¼Œåˆ†é…ç»™ç”¨æˆ·</p>
</li>
<li class="lvl-2">
<p>ä¸€ä¸ªN-kå­—èŠ‚çš„chunkï¼Œæˆä¸ºLast Remainder chunk</p>
</li>
</ul>
<p>åè€…ä¸ºæ–°çš„top chunkï¼Œå¦‚æœè¿top chunkéƒ½ä¸å¤Ÿç”¨äº†ï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>å¦‚æœåœ¨main_arenaä¸­ï¼Œåˆ™ç”¨brk()æ‰©å¼ top hcunk</p>
</li>
<li class="lvl-2">
<p>å¦‚æœåœ¨non_main_arenaä¸­ï¼Œåˆ™ç”¨mmap()åˆ†é…æ–°çš„å †å—</p>
</li>
</ul>
<blockquote>
<p>top chunkçš„PREV_INUSEä½æ€»ä¸º1</p>
</blockquote>
<h4><span id="last-remainder-chunk">Last Remainder chunk</span></h4>
<p>å½“éœ€è¦åˆ†é…ä¸€ä¸ªæ¯”è¾ƒå°çš„kå­—èŠ‚çš„chunkï¼Œä½†æ˜¯small binsä¸­æ‰¾ä¸åˆ°æ»¡è¶³è¦æ±‚çš„ï¼Œä¸”Last Remainder chunkçš„å¤§å°Nèƒ½æ»¡è¶³è¦æ±‚ï¼Œé‚£ä¹ˆLast Remainder chunkå°†è¢«åˆ‡å‰²ä¸ºï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>ä¸€ä¸ªkå­—èŠ‚çš„chunkï¼Œåˆ†é…ç»™ç”¨æˆ·</p>
</li>
<li class="lvl-2">
<p>ä¸€ä¸ªN-kå­—èŠ‚çš„chunkï¼Œæˆä¸ºæ–°çš„Last Remainder chunk</p>
</li>
</ul>
<h3><span id="binçš„ç»“æ„">Binçš„ç»“æ„</span></h3>
<p>binå®ç°äº†ç©ºé—²é“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œç”¨æ¥å­˜å‚¨ç©ºé—²chunkï¼Œå¯åˆ†ä¸ºï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>10ä¸ªfast bins =&gt; å­˜å‚¨åœ¨fastbinsY</p>
</li>
<li class="lvl-2">
<p>1ä¸ªunsorted bins =&gt; å­˜å‚¨åœ¨bin[1]</p>
</li>
<li class="lvl-2">
<p>62ä¸ªsmall bins =&gt; å­˜å‚¨åœ¨bin[2]~bin[63]</p>
</li>
<li class="lvl-2">
<p>63ä¸ªlarge bins =&gt; å­˜å‚¨åœ¨bin[64]~bin[126]</p>
</li>
</ul>
<h4><span id="fast-bins">fast bins</span></h4>
<p>åƒé«˜é€Ÿç¼“å­˜ï¼Œç›¸é‚»ç©ºé—²chunkä¸ä¼šè¢«åˆå¹¶ï¼Œè¿™å›å¯¼è‡´å¤–éƒ¨ç¢ç‰‡å¢å¤šä½†æ˜¯freeæ•ˆç‡æå‡ï¼Œfast binsæ˜¯10ä¸ªLIFOçš„å•é“¾è¡¨ï¼Œæœ€åä¸‰ä¸ªé“¾è¡¨ä¿ç•™æœªä½¿ç”¨</p>
<p>chunkå¤§å°ï¼ˆå«chunkå¤´éƒ¨ï¼‰ï¼š0x10~0x40ï¼ˆ64ä½0x20~0x80ï¼‰Bï¼Œç›¸é‚»binå­˜æ”¾çš„å¤§å°ç›¸å·®0x8ï¼ˆ0x10ï¼‰B</p>
<p><img src="https://pic.imgdb.cn/item/651aca6ac458853aef17817b.jpg" alt></p>
<h4><span id="unsorted-bin">unsorted bin</span></h4>
<p>åƒç¼“å†²åŒºbufferï¼Œå¤§å°è¶…è¿‡fast binsé˜ˆå€¼çš„chunkè¢«é‡Šæ”¾ä¼šåŠ å…¥åˆ°è¿™é‡Œï¼Œä½¿å¾—ptmalloc2å¯ä»¥å¤ç”¨æœ€è¿‘é‡Šæ”¾çš„chunkï¼Œä»è€Œæå‡æ•ˆç‡ï¼›åŒå‘å¾ªç¯é“¾è¡¨</p>
<p>chunkå¤§å°ï¼šå¤§äºglobal_max_fast</p>
<p><img src="https://pic.imgdb.cn/item/651ac256c458853aef16816b.jpg" alt></p>
<h4><span id="small-bins">small bins</span></h4>
<p>å°äº0x200ï¼ˆ0x400ï¼‰Bçš„chunkå«åšsmall chunkï¼Œsmall binså¯ä»¥å­˜æ”¾çš„å°±æ˜¯è¿™äº›chunksï¼Œchunkå¤§å°åŒæ ·æ˜¯ä»16Bå¼€å§‹æ¯æ¬¡+8Bï¼›åŒå‘å¾ªç¯é“¾è¡¨ï¼ŒFIFOï¼Œå’Œfast binsç›¸åï¼Œä¸”ç›¸é‚»çš„ç©ºé—²chunkä¼šè¢«åˆå¹¶</p>
<p>chunkå¤§å°ï¼š0x10~0x1f0 Bï¼ˆ0x20~0x3f0ï¼‰ï¼Œç›¸é‚»binå­˜æ”¾çš„å¤§å°ç›¸å·®0x8ï¼ˆ0x10ï¼‰B</p>
<h4><span id="large-bins">large bins</span></h4>
<p>å¤§äºç­‰äº0x200ï¼ˆ0x400ï¼‰Bçš„chunkå«åšlarge chunkï¼Œè€Œlarge binså¯ä»¥å­˜æ”¾çš„å°±æ˜¯è¿™äº›large chunksï¼›åŒå‘å¾ªç¯é“¾è¡¨ï¼Œæ’å…¥å’Œåˆ é™¤å¯ä»¥å‘ç”Ÿåœ¨ä»»æ„ä½ç½®ï¼Œç›¸é‚»ç©ºé—´chunkä¹Ÿä¼šè¢«åˆå¹¶ï¼Œchunkå¤§å°æ¯”è¾ƒå¤æ‚ï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>å‰32ä¸ªbinsï¼šä»0x200Bå¼€å§‹æ¯æ¬¡+40B</p>
</li>
<li class="lvl-2">
<p>æ¥ä¸‹æ¥çš„16ä¸ªbinsï¼šæ¯æ¬¡+0x200B</p>
</li>
<li class="lvl-2">
<p>æ¥ä¸‹æ¥çš„8ä¸ªbinsï¼šæ¯æ¬¡+0x1000B</p>
</li>
<li class="lvl-2">
<p>æ¥ä¸‹æ¥çš„4ä¸ªbinsï¼šæ¯æ¬¡+0x8000B</p>
</li>
<li class="lvl-2">
<p>æ¥ä¸‹æ¥çš„2ä¸ªbinsï¼šæ¯æ¬¡+0x40000B</p>
</li>
<li class="lvl-2">
<p>æœ€åçš„ä¸€ä¸ªbinï¼šåªæœ‰ä¸€ä¸ªchunkï¼Œå¤§å°å’Œlarge binså‰©ä½™çš„å¤§å°ç›¸åŒ</p>
</li>
</ul>
<p>åŒä¸€ä¸ªbinä¸­chunksä¸æ˜¯ç›¸åŒå¤§å°çš„ï¼ŒæŒ‰å¤§å°é™åºæ’åˆ—ã€‚è¿™å’Œä¸Šé¢çš„å‡ ç§binséƒ½ä¸ä¸€æ ·ï¼Œè€Œåœ¨å–å‡ºchunkæ—¶ï¼Œä¹Ÿéµå¾ªbest fitåŸåˆ™ï¼Œå–å‡ºæ»¡è¶³å¤§å°çš„æœ€å°chunk</p>
<h3><span id="å†…å­˜åˆ†é…æµç¨‹">å†…å­˜åˆ†é…æµç¨‹</span></h3>
<p><img src="https://pic.imgdb.cn/item/651ac911c458853aef175788.jpg" alt></p>
<h3><span id="å†…å­˜é‡Šæ”¾æµç¨‹">å†…å­˜é‡Šæ”¾æµç¨‹</span></h3>
<p><img src="https://pic.imgdb.cn/item/651ac9abc458853aef176be2.jpg" alt></p>

  <p><a class="classtest-link" href="/tags/pwn/" rel="tag">pwn</a> â€” Oct 2, 2023</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/Mykonos-x" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      

      
      <a class="ml-0 footer-link icon" href="https://twitter.com/mykonos_x" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Twitter">
        <svg class="twitter svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg>
      </a>
      

      

      

    </div>
  
</div>

      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>